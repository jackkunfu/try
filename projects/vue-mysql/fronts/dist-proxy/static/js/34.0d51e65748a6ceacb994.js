webpackJsonp([34],{430:function(e,t,s){s(580);var a=s(165)(s(484),s(621),"data-v-44a81240",null);e.exports=a.exports},484:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s(76),r=s.n(a),i=s(75),o=s.n(i);t.default={name:"role",mixins:[mixTable],data:function(){return{activeTab:"0",tabs:[],keys:[{key:"name",str:"角色名称"},{key:"isAbstractStore",str:"虚拟店铺"},{key:"createdTime",str:"添加时间"}],operates:[{f:"edit",str:"编辑"},{f:"del",str:"删除"}],selfApi:{list:{type:"post",url:"/role/roleList"},add:{type:"post",url:"/role/addRole"},edit:{type:"post",url:"/role/update"},del:{type:"post",url:"/role/delete"}},chooseListArr:[],blankChooseListArr:[],searchKeys:["roleName","startTime","endTime"],editKeys:["name","isAbstractStore"]}},mounted:function(){var e=this;return o()(r.a.mark(function t(){var s;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,tryAwait("get","/permission/list");case 2:s=t.sent,s&&(e.tabs=s.model||[]),e.tabs.length>0&&(e.chooseListArr.length=e.tabs.length,e.getPermissionList(e.tabs[0].id,0));case 5:case"end":return t.stop()}},t,e)}))()},methods:{edit:function(e){var t=this;return o()(r.a.mark(function s(){var a;return r.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,tryAwait("get","/role/edit/"+e.row.id);case 2:a=s.sent,a.success?(t.activeTab=0,t.curEditing={index:e.$index,id:e.row.id},t.curOperate="编辑",t.editItem.name=a.model.name,t.editItem.id=e.row.id,t.editItem.isAbstractStore=1==a.model.isStore?"是":"否",t.chooseListArr=JSON.parse(a.model.permissionIds).map(function(e){return e.permissionGropList}),t.isInput=!0,t.isAdd=!1):t.$message({type:"error",message:a.msgInfo});case 4:case"end":return s.stop()}},s,t)}))()},selfAdd:function(){this.activeTab=0,this.chooseListArr=$.extend(!0,[],this.blankChooseListArr)},selfEdit:function(e){},testRule:function(){return!this.editItem.name||""==this.editItem.name.trim()||this.editItem.name.trim().length>10?(this.$message({type:"error",message:"10位以内，不能为空~"}),!1):this.editItem.isAbstractStore&&""!=this.editItem.isAbstractStore?this.getPermissionChoose().hasChoose?(this.editItem.isStore="是"==this.editItem.isAbstractStore?1:0,this.editItem.permissionGroupS=this.getPermissionChoose().choose.map(function(e){return e.id}).join(","),!0):(this.$message({type:"error",message:"权限不能为空"}),!1):(this.$message({type:"error",message:"选择虚拟店铺~"}),!1)},getPermissionList:function(e,t){var s=this;return o()(r.a.mark(function a(){var i;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!s.chooseListArr[t]){a.next=2;break}return a.abrupt("return");case 2:return a.next=4,s.ajax("get","/permission/grop/"+e);case 4:if(a.t0=a.sent.model,a.t0){a.next=7;break}a.t0=[];case 7:i=a.t0,s.chooseListArr[t]||(s.chooseListArr[t]=[]),s.chooseListArr.splice(t,1,i),s.blankChooseListArr[t]||(s.blankChooseListArr[t]=[]),s.blankChooseListArr.splice(t,1,i);case 12:case"end":return a.stop()}},a,s)}))()},getPermissionChoose:function(){var e=[];return this.chooseListArr.forEach(function(t){t.forEach(function(t){t.childVal.forEach(function(t){t.checked&&e.push(t)})})}),{hasChoose:e.length>0,choose:e}}}}},541:function(e,t,s){t=e.exports=s(425)(!1),t.push([e.i,".el-menu-item.is-active[data-v-44a81240]{border-bottom:5px solid #20a0ff}ul.choose-ctn[data-v-44a81240]{margin-top:20px}ul.choose-ctn li[data-v-44a81240]{display:none}ul.choose-ctn li.show[data-v-44a81240]{display:block}.goBack[data-v-44a81240]{top:10px}",""])},580:function(e,t,s){var a=s(541);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);s(426)("7539813f",a,!0)},621:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticStyle:{height:"100%"}},[s("div",{staticClass:"table-main no-nav"},[s("div",{directives:[{name:"show",rawName:"v-show",value:!e.isInput,expression:"!isInput"}],staticClass:"table-ctn"},[s("div",{staticClass:"page-title"},[e._v("角色配置")]),s("div",{staticClass:"search-ctn"},[s("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.searchMsg}},[s("el-form-item",{attrs:{label:"角色名称"}},[s("el-input",{attrs:{placeholder:"输入角色名称"},model:{value:e.searchMsg.roleName,callback:function(t){e.searchMsg.roleName=t},expression:"searchMsg.roleName"}})],1),s("el-form-item",{staticClass:"search-time",attrs:{label:"数据时间段"}},[s("el-col",{attrs:{span:11}},[s("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择开始日期"},model:{value:e.searchMsg.startTime,callback:function(t){e.searchMsg.startTime=t},expression:"searchMsg.startTime"}})],1),s("el-col",{attrs:{span:11}},[s("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择结束日期"},model:{value:e.searchMsg.endTime,callback:function(t){e.searchMsg.endTime=t},expression:"searchMsg.endTime"}})],1)],1)],1),s("el-button",{ref:"search",attrs:{type:"primary",icon:"search"},on:{click:e.searchList}},[e._v("按条件查询")]),s("a",{staticClass:"reset-form",on:{click:e.clearSearch}},[e._v(" 清空筛选条件")]),s("el-button",{ref:"add",attrs:{type:"success"},on:{click:e.add}},[e._v("添加角色")])],1),s("mtable",{attrs:{keys:e.keys,tableData:e.tableData,ops:e.operates,selfApi:e.selfApi,totalPage:e.totalPage,currentPage:e.currentPage,tabOp:e.tabOp},on:{pageChange:e.pageChange,edit:e.edit,del:e.del}})],1),s("div",{directives:[{name:"show",rawName:"v-show",value:e.isInput,expression:"isInput"}],staticClass:"edit-ctn"},[s("div",{staticClass:"page-title"},[e._v(e._s(e.curOperate)+"角色")]),s("div",{staticClass:"form-ctn long"},[s("el-form",{attrs:{model:e.editItem,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"角色名称"}},[s("el-input",{attrs:{placeholder:"10位以内汉字和数字组合"},model:{value:e.editItem.name,callback:function(t){e.editItem.name=t},expression:"editItem.name"}})],1),s("el-form-item",{attrs:{label:"虚拟店铺"}},[s("el-radio-group",{model:{value:e.editItem.isAbstractStore,callback:function(t){e.editItem.isAbstractStore=t},expression:"editItem.isAbstractStore"}},[s("el-radio",{attrs:{label:"是"}}),s("el-radio",{attrs:{label:"否"}})],1)],1),s("el-form-item",{attrs:{label:"拥有权限"}},[s("el-menu",{staticClass:"el-menu-demo",attrs:{theme:"","default-active":e.activeTab+"",mode:"horizontal"}},e._l(e.tabs,function(t,a){return s("el-menu-item",{key:a,attrs:{index:a+""},on:{click:function(s){e.activeTab=a,e.getPermissionList(t.id,a)}}},[e._v(e._s(t.permissionName))])})),s("ul",{staticClass:"choose-ctn"},e._l(e.chooseListArr,function(t,a){return s("li",{key:a,class:e.activeTab==a?"show":""},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:t,stripe:"stripe"}},[s("el-table-column",{attrs:{prop:"gropKey.permissionName",label:"权限名称",width:"200"}}),s("el-table-column",{attrs:{prop:"childVal",label:"权限操作"},scopedSlots:e._u([["default",function(t){return[e._l(t.row.childVal,function(t,a){return[s("el-checkbox",{model:{value:t.checked,callback:function(e){t.checked=e},expression:"op.checked"}},[e._v(e._s(t.permissionName))])]})]}]])})],1)],1)}))],1)],1)],1),s("div",{staticClass:"sure left",on:{click:e.editOk}},[e._v("完成")]),s("div",{staticClass:"goBack",on:{click:e.goBack}},[e._v("返回")])])])])},staticRenderFns:[]}}});