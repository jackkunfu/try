webpackJsonp([15],{461:function(e,t,i){i(575);var s=i(165)(i(514),i(616),"data-v-3f4bfc36",null);e.exports=s.exports},469:function(e,t,i){"use strict";var s=i(166),a={data:function(){return{fileList:[],upImgSize:.5,upImgUrl:s.a.upImgUrl,upImgData:{biz:"vendor"},imageUrl:"",isWithCookie:!0,isMultiple:!1}},methods:{beforeUpload:function(){var e="image/jpeg"===file.type,t=file.size/1024/1024<this.upImgSize;return e||this.$message.error("上传头像图片只能是 JPG 格式!"),t||this.$message.error("上传头像图片大小不能超过"+this.this.upImgSize+"MB!"),e&&t},handleChange:function(){},upImgSuccess:function(){}}};t.a=a},471:function(e,t,i){e.exports={default:i(474),__esModule:!0}},474:function(e,t,i){var s=i(33),a=s.JSON||(s.JSON={stringify:JSON.stringify});e.exports=function(e){return a.stringify.apply(a,arguments)}},514:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i(471),a=i.n(s),r=i(76),n=i.n(r),o=i(75),d=i.n(o),c=i(469);t.default={name:"role",mixins:[mixTable,c.a],data:function(){return{upImgSize:.5,isAdd:!1,newAdminAccount:{realname:"",mobile:"",password:"",isStore:""},fileList:[],addItem:{},powers:[],defaultProps:{children:"children",label:"permissionName"},keys:[{key:"imgUrl",str:"Logo图片"},{key:"vendorName",str:"供应商名称"},{key:"fullAddress",str:"公司地址"},{key:"province",str:"编码"},{key:"createdTime",str:"添加时间"}],operates:[{f:"edit",str:"编辑"},{f:"self",str:"编辑管理员帐号",fun:"editAdmin",ref:""}],selfApi:{list:{type:"get",url:"/vendor/searchList"},edit:{type:"post",url:"/vendor/updateDo"},add:{type:"post",url:"/vendor/addDoAction"}},searchKeys:["vendorName","vendorCode","startTime","endTime"],editKeys:["vendorName","vendorCode","address","logo"]}},mounted:function(){var e=this;return d()(n.a.mark(function t(){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.$set(e.addItem,"name",""),e.$set(e.newAdminAccount,"realname",""),e.$set(e.newAdminAccount,"mobile",""),e.$set(e.newAdminAccount,"password",""),e.$set(e.newAdminAccount,"isStore",""),t.next=7,tryAwait("get","/vendor/tree");case 7:if(t.t0=t.sent.model,t.t0){t.next=10;break}t.t0=[];case 10:e.powers=t.t0,console.log("this.powers"),console.log(e.powers);case 13:case"end":return t.stop()}},t,e)}))()},methods:{upImgSuccess:function(e){if(!e.success)return this.fileList=[],void this.$message({type:"error",message:e.msgInfo});var t=e.model[0];this.fileList=[{name:t.filename,url:t.url}],this.editItem.logo=t.url+t.filename},selfEdit:function(){this.fileList=[{name:this.editItem.vendorLogoUrl,url:this.editItem.imgUrl}],this.editItem.logo=this.editItem.vendorLogoUrl},doneThen:function(e){this.newAdminAccount.vendorId=e.model,this.isInput=!0,this.isAdd=!0},addAdminAccount:function(){var e=this;return d()(n.a.mark(function t(){var i,s,r;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(localStorage.pdSaasVendorId&&"undefined"!=localStorage.pdSaasVendorId){t.next=3;break}return e.$message({type:"error",message:"请重新登录"}),t.abrupt("return");case 3:if(""!=e.newAdminAccount.realname.trim()){t.next=6;break}return e.$message({type:"error",message:"填写名称~"}),t.abrupt("return",!1);case 6:if(""!=e.newAdminAccount.mobile.trim()&&/^1[3|4|5|8][0-9]\d{4,8}$/.test(e.newAdminAccount.mobile.trim())){t.next=9;break}return e.$message({type:"error",message:"手机号有误~"}),t.abrupt("return",!1);case 9:if(""!=e.newAdminAccount.isStore.trim()){t.next=12;break}return e.$message({type:"error",message:"请选择是否是虚拟店铺~"}),t.abrupt("return",!1);case 12:if(i=e.$refs.powerTree.getCheckedNodes(),0!=i.length){t.next=16;break}return e.$message({type:"error",message:"须配置权限~"}),t.abrupt("return",!1);case 16:return e.newAdminAccount.password&&""!=e.newAdminAccount.password.trim()||(e.newAdminAccount.password=e.newAdminAccount.mobile.substr(e.newAdminAccount.mobile.length-6,6)),s=e.newAdminAccount,s.permissionIdS=a()(i),s.vendorId=localStorage.pdSaasVendorId,t.next=22,tryAwait("post","/vendor/addAdminDoAction",s);case 22:r=t.sent,r.success&&(e.isInput=!0,e.isAdd=!1);case 24:case"end":return t.stop()}},t,e)}))()},province:function(e){this.editItem.province=e.code,this.editItem.provinceName=e.value,this.editItem.city="",this.editItem.zone=""},city:function(e){this.editItem.city=e.code,this.editItem.cityName=e.value,this.editItem.zone=""},area:function(e){this.editItem.zone=e.code,this.editItem.zoneName=e.value},testRule:function(){if(""==this.editItem.vendorName.trim())return this.$message({type:"error",message:"填写名称~"}),!1;if(""==this.editItem.vendorCode.trim())return this.$message({type:"error",message:"输入编码~"}),!1;if(!this.editItem.province||!this.editItem.city||!this.editItem.zone)return this.$message({type:"error",message:"地址选择有误"}),!1;if(""==this.editItem.address.trim())return this.$message({type:"error",message:"详细地址选择有误"}),!1;if(!this.editItem.logo||""==this.editItem.logo)return this.$message({type:"error",message:"还没上传图片~"}),!1;var e={vendorName:this.editItem.vendorName,vendorCode:this.editItem.vendorCode,logo:this.editItem.logo,province:this.editItem.province,city:this.editItem.city,zone:this.editItem.zone,address:this.editItem.address,provinceName:this.editItem.provinceName,cityName:this.editItem.cityName,zoneName:this.editItem.zoneName};return this.editItem.id&&(e.id=this.editItem.id),this.editItem=e,!0},editAdmin:function(e){var t=this;return d()(n.a.mark(function i(){var s;return n.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,tryAwait("get","/vendor/editAdmin/"+e.row.id);case 2:s=i.sent,s.success&&(t.newAdminAccount=s.model,t.powers=JSON.parse(s.model.gropPermission),t.newAdminAccount.isStore=s.model.isStroe),t.isAdd=!0,t.isInput=!0;case 6:case"end":return i.stop()}},i,t)}))()}}}},536:function(e,t,i){t=e.exports=i(425)(!1),t.push([e.i,".el-upload__tip[data-v-3f4bfc36]{margin-top:-35px;text-align:center}.edit-address .address select[data-v-3f4bfc36]{width:115px!important;height:36px!important;border-radius:5px!important;border:1px solid #8391a5!important}.avatar-uploader .el-upload[data-v-3f4bfc36]{border:1px dashed #d9d9d9;border-radius:6px;cursor:pointer;position:relative;overflow:hidden}.avatar-uploader .el-upload[data-v-3f4bfc36]:hover{border-color:#20a0ff}.avatar-uploader-icon[data-v-3f4bfc36]{font-size:28px;color:#8c939d;width:178px;height:178px;line-height:178px;text-align:center}.avatar[data-v-3f4bfc36]{width:178px;height:178px;display:block}",""])},575:function(e,t,i){var s=i(536);"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);i(426)("62a932f6",s,!0)},616:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{height:"100%"}},[i("div",{staticClass:"table-main no-nav"},[e.isInput?e._e():i("div",{staticClass:"table-ctn"},[i("div",{staticClass:"page-title"},[e._v("供应商配置")]),i("div",{staticClass:"search-ctn"},[i("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.searchMsg}},[i("el-form-item",{attrs:{label:"供应商名称"}},[i("el-input",{attrs:{placeholder:"输入姓名关键字，请勿带符号",value:"searchMsg.vendorName"},model:{value:e.searchMsg.vendorName,callback:function(t){e.searchMsg.vendorName=t},expression:"searchMsg.vendorName"}})],1),i("el-form-item",{attrs:{label:"管理员手机"}},[i("el-input",{attrs:{placeholder:"输入管理员手机",value:"searchMsg.mobile"},model:{value:e.searchMsg.mobile,callback:function(t){e.searchMsg.mobile=t},expression:"searchMsg.mobile"}})],1),i("br"),i("el-form-item",{staticClass:"search-time",attrs:{label:"活动时间"}},[i("el-col",{attrs:{span:11}},[i("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择开始日期"},model:{value:e.searchMsg.startTime,callback:function(t){e.searchMsg.startTime=t},expression:"searchMsg.startTime"}})],1),i("el-col",{attrs:{span:11}},[i("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择结束日期"},model:{value:e.searchMsg.endTime,callback:function(t){e.searchMsg.endTime=t},expression:"searchMsg.endTime"}})],1)],1)],1),i("el-button",{ref:"search",attrs:{type:"primary",icon:"search"},on:{click:e.searchList}},[e._v("按条件查询")]),i("a",{staticClass:"reset-form",on:{click:e.clearSearch}},[e._v(" 清空筛选条件")]),i("el-button",{ref:"add",attrs:{type:"success"},on:{click:e.add}},[e._v("添加供应商")])],1),i("mtable",{attrs:{keys:e.keys,tableData:e.tableData,ops:e.operates,selfApi:e.selfApi,totalPage:e.totalPage,currentPage:e.currentPage,tabOp:e.tabOp},on:{edit:e.edit,editAdmin:e.editAdmin,pageChange:e.pageChange}})],1),e.isInput&&!e.isAdd?i("div",{staticClass:"edit-ctn"},[i("div",{staticClass:"page-title"},[e._v(e._s(e.curOperate)+"供应商")]),i("div",{staticClass:"form-ctn"},[i("el-form",{staticStyle:{width:"450px"},attrs:{model:e.editItem,"label-width":"90px"}},[i("el-form-item",{attrs:{label:"供应商名称"}},[i("el-input",{attrs:{type:"text",placeholder:"20个以内的汉字和数字组合"},model:{value:e.editItem.vendorName,callback:function(t){e.editItem.vendorName=t},expression:"editItem.vendorName"}})],1),i("el-form-item",{attrs:{label:"供应商编码"}},[i("el-input",{attrs:{type:"text",placeholder:"输入供应商编码"},model:{value:e.editItem.vendorCode,callback:function(t){e.editItem.vendorCode=t},expression:"editItem.vendorCode"}})],1),i("div",{staticClass:"border-line"}),i("el-form-item",{staticClass:"edit-address",attrs:{label:"总部地址"}},[i("v-distpicker",{attrs:{province:e.editItem.provinceName,city:e.editItem.cityName,area:e.editItem.zoneName},on:{province:e.province,city:e.city,area:e.area}})],1),i("el-form-item",{attrs:{label:"详细地址"}},[i("el-input",{attrs:{type:"textarea",placeholder:"详细地址"},model:{value:e.editItem.address,callback:function(t){e.editItem.address=t},expression:"editItem.address"}})],1),i("el-form-item",{attrs:{label:"logo图片"}},[i("el-upload",{staticClass:"avatar-uploader",attrs:{accept:"image/*",drag:"drag",action:e.upImgUrl,name:"upfile","file-list":e.fileList,"list-type":"picture","with-credentials":e.isWithCookie,multiple:e.isMultiple,data:e.upImgData,"on-success":e.upImgSuccess}},[i("i",{staticClass:"el-icon-upload"}),i("div",{staticClass:"el-upload__tip",slot:"tip"},[e._v("只能上传jpg/png文件，且不超过500kb")])])],1),i("div",{staticClass:"border-line"}),i("el-button",{staticClass:"left",attrs:{type:"primary"},on:{click:e.editOk}},[e._v("完成")]),i("el-button",{staticClass:"left",attrs:{type:"success"},on:{click:function(t){e.editOk(e.doneThen)}}},[e._v("完成，去配置对应管理员")]),i("div",{staticClass:"goBack",on:{click:e.goBack}},[e._v("返回")])],1)],1)]):e._e(),e.isAdd?i("div",{staticClass:"edit-ctn"},[i("div",{staticClass:"page-title"},[e._v("编辑供应商管理员账号")]),i("div",{staticClass:"form-ctn"},[i("el-form",{attrs:{model:e.newAdminAccount,"label-width":"80px"}},[i("el-form-item",{attrs:{label:"真实姓名"}},[i("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"20个以内的汉字和数字组合"},model:{value:e.newAdminAccount.realname,callback:function(t){e.newAdminAccount.realname=t},expression:"newAdminAccount.realname"}})],1),i("el-form-item",{attrs:{label:"手机号码"}},[i("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"11位中国大陆手机号码"},model:{value:e.newAdminAccount.mobile,callback:function(t){e.newAdminAccount.mobile=t},expression:"newAdminAccount.mobile"}})],1),i("el-form-item",{attrs:{label:"登录密码"}},[i("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"不填写则默认为手机号码后6位"},model:{value:e.newAdminAccount.password,callback:function(t){e.newAdminAccount.password=t},expression:"newAdminAccount.password"}})],1),i("el-form-item",{attrs:{label:"虚拟店铺"}},[i("el-radio-group",{model:{value:e.newAdminAccount.isStore,callback:function(t){e.newAdminAccount.isStore=t},expression:"newAdminAccount.isStore"}},[i("el-radio",{attrs:{label:1}},[e._v("添加至虚拟店铺")]),i("el-radio",{attrs:{label:0}},[e._v("不添加至虚拟店铺")])],1)],1),i("div",{staticClass:"border-line"}),i("el-form-item",{attrs:{label:"业务权限"}},[i("el-tree",{ref:"powerTree",attrs:{"default-expanded-keys":[],"default-checked-keys":[],data:e.powers,props:e.defaultProps,"show-checkbox":"show-checkbox"}})],1),i("el-button",{staticClass:"left",attrs:{type:"primary"},on:{click:e.addAdminAccount}},[e._v("完成")]),i("div",{staticClass:"goBack",on:{click:e.goBack}},[e._v("返回")])],1)],1)]):e._e()])])},staticRenderFns:[]}}});